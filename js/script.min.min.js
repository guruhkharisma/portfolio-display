var portfolio=function(){var e=$("#main"),n=e.children("section"),r=$("#work-section"),o=$("#work-items > li"),a=$("#panel-work-items"),t=a.children("div"),s=a.find(".panel-info"),i=t.length,l=$(".work_count"),c=a.find("nav > span.next-work"),d=a.find("nav > span.prev-work"),u=!1,k=a.find("nav > span.icon-close"),f={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[Modernizr.prefixed("transition")],w=Modernizr.csstransitions;return{init:function(){l.html(i-1),n.each(function(){var n=$(this);n.on("click",function(){n.data("open")||(n.data("open",!0).addClass("expand expand-top"),e.addClass("expand-item"))}).find("span.icon-close").on("click",function(){return n.data("open",!1).removeClass("expand").on(f,function(n){if(!$(n.target).is("section"))return!1;$(this).off(f).removeClass("expand-top")}),w||n.removeClass("expand-top"),e.removeClass("expand-item"),!1})}),o.on("click",function(n){r.addClass("scale-down"),a.addClass("panel-items-show");var e=a.find("[data-panel='"+$(this).data("panel")+"']");return currentWorkPanel=e.index(),s.html(currentWorkPanel+"/"+(i-1)),e.addClass("show-work"),!1}),$("body").on("swipeleft",function(n){n.preventDefault(),r.hasClass("scale-down")&&c.click()}),$("body").on("swiperight",function(n){n.preventDefault(),r.hasClass("scale-down")&&d.click()}),c.on("click",function(n){if(u)return!1;u=!0;var e=t.eq(currentWorkPanel);currentWorkPanel=currentWorkPanel<i-1?currentWorkPanel+1:1;var r=t.eq(currentWorkPanel);return s.html(currentWorkPanel+"/"+(i-1)),e.removeClass("show-work").addClass("hide-current-work").on(f,function(n){if(!$(n.target).is("div"))return!1;$(this).off(f).removeClass("hide-current-work"),u=!1}),w||(e.removeClass("hide-current-work"),u=!1),r.addClass("show-work"),!1}),$("body").on("keydown",function(n){r.hasClass("scale-down")&&(37==n.keyCode?d.click():39==n.keyCode&&c.click())}),d.on("click",function(n){if(u)return!1;u=!0;var e=t.eq(currentWorkPanel);console.log("current = "+currentWorkPanel+", totalWorkPanels = "+i),currentWorkPanel=1<currentWorkPanel?currentWorkPanel-1:i-1,s.html(currentWorkPanel+"/"+(i-1));var r=t.eq(currentWorkPanel);return e.removeClass("show-work").addClass("hide-current-work").on(f,function(n){if(!$(n.target).is("div"))return!1;$(this).off(f).removeClass("hide-current-work"),u=!1}),w||(e.removeClass("hide-current-work"),u=!1),r.addClass("show-work"),!1}),k.on("click",function(n){return r.removeClass("scale-down"),a.removeClass("panel-items-show"),t.eq(currentWorkPanel).removeClass("show-work"),!1})}}}();